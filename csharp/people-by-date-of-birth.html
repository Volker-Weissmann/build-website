<figure class="highlight"><section><pre><code><span class='k'>partial</span> <span class='k'>class</span> <span class='m'>SocialNetwork</span> {
  Dictionary&lt;DateTime, Dictionary&lt;<span class='b'>int</span>, <span class='m'>Person</span>&gt;&gt; peopleByDateOfBirth =
    <span class='k'>new</span> Dictionary&lt;DateTime, Dictionary&lt;<span class='b'>int</span>, <span class='m'>Person</span>&gt;&gt;();

  <span class='k'>public</span> <span class='m'>Person</span>[] PeopleBornOn(DateTime date) {
    <span class='k'>if</span> (peopleByDateOfBirth.ContainsKey(date))
      <span class='k'>return</span> peopleByDateOfBirth[date].Values.ToArray();
    <span class='k'>else</span>
      <span class='k'>return</span> <span class='k'>new</span> <span class='m'>Person</span>[<span class='n'>0</span>];
  }

  <span class='k'>public</span> <span class='k'>void</span> Add(<span class='m'>Person</span> person) {
    people[person.id] = person;
    <span class='k'>if</span> (!peopleByDateOfBirth.ContainsKey(person.dateOfBirth)) <span class='c'>// NEW</span>
      peopleByDateOfBirth[person.dateOfBirth] = <span class='k'>new</span> Dictionary&lt;<span class='b'>int</span>, <span class='m'>Person</span>&gt;(); <span class='c'>// NEW</span>
    peopleByDateOfBirth[person.dateOfBirth][person.id] = person; <span class='c'>// NEW</span>
  }

  <span class='k'>public</span> <span class='k'>void</span> Remove(<span class='m'>Person</span> person) {
    <span class='k'>if</span> (people.Remove(person.id)) {
      person.Delete();
      peopleByDateOfBirth[person.dateOfBirth].Remove(person.id); <span class='c'>// NEW</span>
    }
  }
}
</code></pre></section></figure>
